from collections import defaultdict
from dataclasses import dataclass
from itertools import product
import random
from random import seed, sample
from typing import Optional

import networkx as nx
from networkx import random_geometric_graph, DiGraph

from pdm4ar.exercises.ex02.structures import AdjacencyList, Path, OpenedNodes, Query, Grid


@dataclass
class GraphSearchProblem:
    queries: set[Query]
    graph_id: str
    graph: AdjacencyList


@dataclass
class GridSearchProblem(GraphSearchProblem):
    graph: Optional[AdjacencyList]
    grid: Grid


def networkx_2_adjacencylist(nxgraph: DiGraph) -> AdjacencyList:
    adj_list = dict()
    atlas = nxgraph.adj._atlas
    for n in atlas.keys():
        adj_list[n] = set(atlas[n].keys())
    return adj_list


def queries_from_adjacency(adj_list: AdjacencyList, n: int, n_seed=None) -> set[Query]:
    seed(n_seed)
    graph_queries = set()
    nodes = list(adj_list.keys())
    for _ in range(n):
        query_pair = sample(nodes, 2)
        graph_queries.add(tuple(query_pair))
    return graph_queries


def grid_to_adjacency_list(grid: Grid) -> AdjacencyList:
    """
    Converts a grid to an adjacency list.
    :param grid: A square matrix representing the grid.
    :return: An adjacency list representation of the graph.
    """
    adjacency_list: AdjacencyList = {}
    n = len(grid)
    for i in range(n):
        if len(grid[i]) != n:
            raise ValueError("Grid must be square.")

    def idx2id(r: int, c: int) -> int:
        return r * n + c + 1

    for r in range(n):
        for c in range(n):
            node_id = idx2id(r, c)
            neighbors = set()
            if grid[r][c] == 1:
                continue
            # Check all 4 possible directions (up, down, left, right)
            possible_directions = [(-1, 0), (1, 0), (0, -1), (0, 1)]
            for dr, dc in possible_directions:
                nr, nc = r + dr, c + dc
                if 0 <= nr < n and 0 <= nc < n and grid[nr][nc] != 1:
                    neighbor_id = idx2id(nr, nc)
                    neighbors.add(neighbor_id)
            adjacency_list[node_id] = set(sorted(neighbors))
    return adjacency_list


def generate_random_grid(n: int, d: float, seed: int = None) -> Grid:
    """
    Generate an n x n grid with density d of 1s, placed randomly.

    Parameters:
    - n (int): size of the grid (n x n)
    - d (float): density of 1s (between 0 and 1)
    - seed (int): random seed (optional)

    Returns:
    - Grid: grid with 0s and 1s
    """
    if seed is not None:
        random.seed(seed)
    else:
        random.seed()

    total_cells = n * n
    num_ones = int(round(total_cells * d))
    num_zeros = total_cells - num_ones

    # Create a flat list with the correct number of 1s and 0s
    values = [1] * num_ones + [0] * num_zeros
    random.shuffle(values)

    # Convert flat list into 2D grid
    grid = [values[i * n : (i + 1) * n] for i in range(n)]
    return grid


def generate_start_and_goal_from_grid(grid: Grid, seed: int = None) -> Query:
    """
    Generate a random start and goal position on a grid where both are on white squares (0s).

    Parameters:
    - grid (Grid): 2D grid with 0s (white) and 1s (black)
    - seed (int): optional random seed

    Returns:
    - Query: representing the start and goal positions as node IDs.
    """

    def idx2id(r: int, c: int) -> int:
        return r * n + c + 1

    if seed is not None:
        random.seed(seed)
    else:
        random.seed()

    n = len(grid)
    white_cells_id = [idx2id(i, j) for i in range(n) for j in range(n) if grid[i][j] == 0]

    if len(white_cells_id) < 2:
        raise ValueError("Not enough white cells to choose distinct start and goal positions.")

    start, goal = random.sample(white_cells_id, 2)
    return start, goal


def generate_queries_grid(grid: Grid, n: int, seed: int = None) -> set[Query]:
    """
    Generate a set of n unique (start, goal) queries on white squares.

    Parameters:
    - grid (Grid): 2D grid with 0s (white) and 1s (black)
    - n (int): number of query pairs to generate
    - seed (int): optional random seed

    Returns:
    - Set[Query]: set of (start, goal) position pairs
    """

    if seed is not None:
        random.seed(seed)
    else:
        random.seed()

    seeds = [random.randint(0, 10000) for _ in range(n)]
    queries = set()
    for seed in seeds:
        start, goal = generate_start_and_goal_from_grid(grid, seed)
        query: Query = (start, goal)
        if query not in queries:
            queries.add(query)

    if len(queries) < n:
        raise RuntimeError("Failed to generate enough unique queries.")
    return queries


def get_graph_search_problems(
    n_seed: int = None,
    height: int = 4,
    extra_test_graph_problems: list[GraphSearchProblem] = [],
) -> list[GraphSearchProblem]:
    graphsearch_prob = list()
    # test graph 1
    easy01_id = "easy01"
    easy01: AdjacencyList = {1: {2, 3}, 2: {3, 4}, 3: {4}, 4: {3}, 5: {6}, 6: {3}}
    easy01_queries = {(1, 4), (2, 6), (6, 1), (6, 6), (5, 4)}
    graphsearch_prob.append(GraphSearchProblem(graph=easy01, queries=easy01_queries, graph_id=easy01_id))

    # test graph 2
    size_g2 = 10
    graph02_id = "graph02"
    graph02_nx = random_geometric_graph(size_g2, 0.5, seed=9)
    graph02: AdjacencyList = networkx_2_adjacencylist(graph02_nx)
    graph02_queries = queries_from_adjacency(graph02, 3, n_seed)
    graphsearch_prob.append(GraphSearchProblem(graph=graph02, queries=graph02_queries, graph_id=graph02_id))

    # test grid 1
    grid_id = "grid01"
    grid01: Grid = [[1, 1, 0, 0], [0, 1, 0, 0], [0, 0, 0, 1], [0, 1, 0, 0]]
    grid01_queries = {(5, 16), (4, 5), (10, 3)}
    graphsearch_prob.append(GridSearchProblem(graph=None, grid=grid01, queries=grid01_queries, graph_id=grid_id))

    # test grid 2
    grid_id = "grid02"
    grid02: Grid = generate_random_grid(20, 0.25, 3)
    grid02_queries = generate_queries_grid(grid02, 3, 4)
    graphsearch_prob.append(GridSearchProblem(graph=None, grid=grid02, queries=grid02_queries, graph_id=grid_id))

    for extra_problem in extra_test_graph_problems:
        graphsearch_prob.append(extra_problem)
    return graphsearch_prob


def ex2_get_expected_results() -> list[Optional[list[tuple[Path, OpenedNodes]]]]:
    expected_results = defaultdict(dict)

    # expected results graph 1 dfs
    expected_results[0] = [
        ([], [2, 3, 4]),
        ([6], [6]),
        ([], [6, 3, 4]),
        ([5, 6, 3, 4], [5, 6, 3, 4]),
        ([1, 2, 4], [1, 2, 4]),
    ]
    # expected results graph 1 bfs
    expected_results[1] = [
        ([], [2, 3, 4]),
        ([6], [6]),
        ([], [6, 3, 4]),
        ([5, 6, 3, 4], [5, 6, 3, 4]),
        ([1, 2, 4], [1, 2, 3, 4]),
    ]
    # expected results graph 1 id
    expected_results[2] = [
        ([], [2, 3, 4]),
        ([6], [6]),
        ([], [6, 3, 4]),
        ([5, 6, 3, 4], [5, 6, 3, 4]),
        ([1, 2, 4], [1, 2, 4]),
    ]

    # test graph 2 dfs
    expected_results[3] = [
        ([1, 2, 0, 6], [1, 2, 0, 6]),
        ([3, 6, 4], [3, 6, 0, 2, 1, 9, 5, 8, 4]),
        ([7, 0, 2], [7, 0, 2]),
    ]

    # test graph 2 bfs
    expected_results[4] = [
        ([1, 4, 6], [1, 2, 4, 5, 9, 0, 8, 6]),
        ([3, 6, 4], [3, 6, 7, 0, 4]),
        ([7, 0, 2], [7, 0, 3, 4, 6, 8, 2]),
    ]

    # test graph 2 id
    expected_results[5] = [
        ([1, 4, 6], [1, 2, 0, 8, 4, 6]),
        ([3, 6, 4], [3, 6, 0, 4]),
        ([7, 0, 2], [7, 0, 2]),
    ]

    # test grid 1 dfs
    expected_results[6] = [
        ([4, 3, 7, 11, 10, 9, 5], [4, 3, 7, 11, 10, 9, 5]),
        ([5, 9, 10, 11, 15, 16], [5, 9, 10, 11, 7, 3, 4, 8, 15, 16]),
        ([10, 11, 7, 3], [10, 9, 5, 13, 11, 7, 3]),
    ]

    # test grid 1 bfs
    expected_results[7] = [
        ([4, 3, 7, 11, 10, 9, 5], [4, 3, 8, 7, 11, 10, 15, 9, 16, 5]),
        ([5, 9, 10, 11, 15, 16], [5, 9, 10, 13, 11, 7, 15, 3, 8, 16]),
        ([10, 11, 7, 3], [10, 9, 11, 5, 13, 7, 15, 3]),
    ]

    # test grid 1 id
    expected_results[8] = [
        ([4, 3, 7, 11, 10, 9, 5], [4, 3, 7, 11, 10, 9, 5]),
        ([5, 9, 10, 11, 15, 16], [5, 9, 10, 11, 7, 3, 8, 15, 16]),
        ([10, 11, 7, 3], [10, 9, 5, 13, 11, 7, 3]),
    ]

    # test grid 2 dfs
    expected_results[9] = [
        (
            [
                386,
                366,
                346,
                326,
                306,
                286,
                266,
                246,
                226,
                225,
                205,
                185,
                165,
                145,
                125,
                105,
                85,
                65,
                64,
                63,
                43,
                23,
                24,
                25,
                5,
                6,
                7,
                8,
                9,
                10,
                30,
                31,
                32,
                33,
                13,
                14,
                15,
                35,
                55,
                54,
                74,
                73,
                72,
                92,
                91,
                90,
                89,
                109,
                108,
                128,
                148,
                149,
                150,
                151,
                171,
                172,
                192,
                212,
                213,
                214,
                215,
                216,
                217,
                197,
                177,
                157,
                137,
                117,
                116,
                96,
                76,
                77,
                78,
                98,
            ],
            [
                386,
                366,
                346,
                326,
                306,
                286,
                266,
                246,
                226,
                225,
                205,
                185,
                165,
                145,
                125,
                105,
                85,
                65,
                64,
                63,
                43,
                23,
                3,
                2,
                1,
                21,
                41,
                61,
                81,
                101,
                102,
                122,
                142,
                141,
                161,
                162,
                163,
                183,
                203,
                202,
                201,
                222,
                242,
                241,
                261,
                281,
                282,
                283,
                302,
                322,
                321,
                341,
                361,
                362,
                382,
                383,
                381,
                342,
                343,
                344,
                324,
                364,
                301,
                243,
                244,
                264,
                262,
                223,
                182,
                24,
                25,
                5,
                6,
                7,
                8,
                9,
                10,
                30,
                31,
                32,
                33,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                39,
                38,
                37,
                35,
                55,
                54,
                74,
                73,
                72,
                92,
                91,
                90,
                70,
                89,
                109,
                108,
                107,
                87,
                67,
                47,
                46,
                48,
                49,
                68,
                128,
                148,
                147,
                167,
                187,
                188,
                208,
                209,
                228,
                207,
                149,
                150,
                151,
                131,
                171,
                172,
                173,
                192,
                212,
                211,
                213,
                214,
                194,
                215,
                216,
                217,
                197,
                177,
                157,
                137,
                117,
                116,
                96,
                76,
                77,
                78,
                79,
                99,
                100,
                119,
                98,
            ],
        ),
        (
            [
                43,
                23,
                3,
                2,
                1,
                21,
                41,
                61,
                81,
                101,
                102,
                122,
                142,
                162,
                163,
                164,
                144,
                124,
                125,
                105,
                85,
                86,
                87,
                67,
                47,
                27,
                7,
                8,
                9,
                10,
                30,
                31,
                32,
                33,
                13,
                14,
                15,
                35,
                55,
                54,
                74,
                73,
                72,
                92,
                91,
                90,
                89,
                109,
                108,
                128,
                148,
                147,
                167,
                187,
                186,
                185,
                205,
                204,
                203,
                202,
                222,
                242,
                241,
                261,
                281,
                282,
                302,
                322,
                342,
                343,
                344,
            ],
            [
                43,
                23,
                3,
                2,
                1,
                21,
                41,
                61,
                62,
                81,
                101,
                102,
                122,
                142,
                141,
                161,
                162,
                163,
                164,
                144,
                124,
                125,
                105,
                85,
                65,
                64,
                84,
                86,
                87,
                67,
                47,
                27,
                7,
                6,
                5,
                25,
                8,
                9,
                10,
                30,
                31,
                32,
                33,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                39,
                38,
                37,
                35,
                55,
                54,
                74,
                73,
                72,
                92,
                91,
                90,
                70,
                89,
                109,
                108,
                128,
                148,
                147,
                146,
                167,
                187,
                186,
                185,
                205,
                204,
                203,
                202,
                201,
                222,
                242,
                241,
                261,
                281,
                282,
                283,
                302,
                322,
                321,
                341,
                361,
                362,
                382,
                383,
                381,
                342,
                343,
                344,
            ],
        ),
        (
            [
                287,
                267,
                247,
                227,
                207,
                187,
                167,
                147,
                146,
                126,
                106,
                86,
                85,
                65,
                64,
                63,
                43,
                23,
                3,
                2,
                1,
                21,
                41,
                61,
                81,
                101,
                102,
                122,
                142,
                162,
                163,
                164,
                165,
                185,
                205,
                204,
                203,
                202,
                222,
                242,
                241,
                261,
                281,
                282,
                302,
                322,
                342,
                343,
                344,
                324,
                325,
                326,
                327,
                347,
                348,
                349,
                329,
                330,
                310,
                290,
                270,
                250,
                251,
                252,
                232,
                212,
                192,
                172,
                171,
                151,
                131,
                111,
                91,
                92,
                72,
                73,
                53,
                33,
                13,
                14,
                15,
                35,
                55,
                56,
                76,
                77,
                78,
                79,
                99,
                119,
                118,
                117,
                137,
                157,
                158,
                178,
                198,
                197,
                217,
                216,
                215,
                235,
                255,
                256,
                276,
                277,
                278,
                258,
                259,
                260,
                280,
                300,
                299,
                319,
                339,
                338,
                337,
                317,
                316,
                315,
                335,
                355,
                356,
            ],
            [
                287,
                267,
                247,
                227,
                207,
                187,
                167,
                147,
                146,
                126,
                106,
                86,
                85,
                65,
                64,
                63,
                43,
                23,
                3,
                2,
                1,
                21,
                41,
                61,
                81,
                101,
                102,
                122,
                142,
                141,
                161,
                162,
                163,
                164,
                144,
                124,
                165,
                185,
                205,
                204,
                203,
                202,
                201,
                222,
                242,
                241,
                261,
                281,
                282,
                283,
                302,
                322,
                321,
                341,
                361,
                362,
                382,
                383,
                381,
                342,
                343,
                344,
                324,
                325,
                326,
                306,
                327,
                347,
                348,
                349,
                329,
                330,
                310,
                290,
                270,
                250,
                249,
                251,
                252,
                232,
                212,
                192,
                172,
                171,
                151,
                131,
                111,
                91,
                90,
                70,
                89,
                109,
                108,
                128,
                129,
                149,
                169,
                92,
                72,
                73,
                53,
                33,
                13,
                14,
                15,
                16,
                17,
                18,
                19,
                20,
                39,
                38,
                37,
                35,
                55,
                56,
                76,
                77,
                78,
                79,
                99,
                100,
                119,
                118,
                117,
                116,
                137,
                157,
                158,
                159,
                160,
                180,
                200,
                178,
                198,
                197,
                217,
                216,
                215,
                214,
                194,
                234,
                235,
                255,
                256,
                276,
                277,
                278,
                258,
                238,
                259,
                260,
                280,
                300,
                299,
                319,
                339,
                338,
                337,
                317,
                316,
                315,
                295,
                294,
                274,
                335,
                334,
                333,
                313,
                332,
                353,
                373,
                372,
                371,
                392,
                374,
                375,
                395,
                396,
                394,
                393,
                355,
                356,
            ],
        ),
    ]

    # test grid 2 bfs
    expected_results[10] = [
        (
            [
                386,
                366,
                346,
                326,
                306,
                286,
                266,
                267,
                268,
                269,
                249,
                250,
                251,
                252,
                232,
                212,
                213,
                214,
                215,
                216,
                217,
                197,
                177,
                157,
                137,
                117,
                118,
                98,
            ],
            [
                386,
                366,
                385,
                387,
                346,
                388,
                326,
                345,
                347,
                306,
                325,
                327,
                344,
                348,
                286,
                307,
                324,
                343,
                364,
                349,
                266,
                285,
                287,
                308,
                342,
                329,
                369,
                246,
                265,
                267,
                288,
                322,
                341,
                362,
                330,
                226,
                245,
                247,
                264,
                268,
                302,
                321,
                361,
                382,
                310,
                225,
                227,
                244,
                269,
                282,
                301,
                381,
                383,
                290,
                311,
                205,
                207,
                228,
                243,
                249,
                270,
                262,
                281,
                283,
                185,
                204,
                187,
                208,
                223,
                242,
                250,
                271,
                261,
                165,
                184,
                186,
                203,
                167,
                188,
                209,
                222,
                241,
                251,
                272,
                145,
                164,
                183,
                202,
                147,
                168,
                252,
                125,
                144,
                146,
                163,
                182,
                201,
                148,
                169,
                232,
                253,
                105,
                124,
                126,
                162,
                128,
                149,
                212,
                233,
                85,
                106,
                142,
                161,
                108,
                129,
                150,
                192,
                211,
                213,
                234,
                65,
                84,
                86,
                107,
                122,
                141,
                109,
                151,
                172,
                214,
                235,
                64,
                87,
                102,
                89,
                110,
                131,
                171,
                173,
                194,
                215,
                255,
                63,
                67,
                101,
                90,
                111,
                216,
                256,
                275,
                43,
                62,
                47,
                68,
                81,
                70,
                91,
                112,
                217,
                276,
                274,
                295,
                23,
                42,
                61,
                27,
                46,
                48,
                92,
                113,
                197,
                218,
                237,
                277,
                296,
                294,
                315,
                3,
                24,
                41,
                7,
                26,
                49,
                72,
                93,
                114,
                133,
                177,
                198,
                219,
                238,
                278,
                297,
                316,
                335,
                2,
                25,
                21,
                6,
                8,
                29,
                73,
                94,
                134,
                157,
                178,
                258,
                298,
                317,
                336,
                334,
                355,
                1,
                5,
                9,
                30,
                53,
                74,
                154,
                137,
                158,
                259,
                299,
                337,
                356,
                333,
                375,
                10,
                31,
                33,
                54,
                155,
                117,
                138,
                159,
                260,
                300,
                319,
                338,
                357,
                313,
                332,
                353,
                374,
                395,
                32,
                51,
                13,
                34,
                55,
                175,
                116,
                118,
                160,
                280,
                320,
                339,
                358,
                377,
                373,
                394,
                396,
                14,
                35,
                56,
                96,
                98,
            ],
        ),
        (
            [43, 42, 41, 61, 81, 101, 102, 122, 142, 162, 182, 202, 222, 242, 262, 282, 302, 322, 342, 343, 344],
            [
                43,
                23,
                42,
                63,
                3,
                24,
                41,
                62,
                64,
                2,
                25,
                21,
                61,
                65,
                84,
                1,
                5,
                26,
                81,
                85,
                6,
                27,
                46,
                101,
                86,
                105,
                7,
                47,
                102,
                87,
                106,
                125,
                8,
                48,
                67,
                122,
                107,
                126,
                124,
                145,
                9,
                49,
                68,
                142,
                108,
                146,
                144,
                165,
                10,
                29,
                141,
                162,
                109,
                128,
                147,
                164,
                185,
                30,
                161,
                163,
                182,
                89,
                110,
                129,
                148,
                167,
                184,
                186,
                205,
                31,
                183,
                202,
                90,
                111,
                149,
                168,
                187,
                204,
                225,
                32,
                51,
                203,
                201,
                222,
                70,
                91,
                112,
                131,
                150,
                169,
                188,
                207,
                226,
                245,
                33,
                223,
                242,
                92,
                113,
                151,
                208,
                227,
                246,
                244,
                265,
                13,
                34,
                53,
                243,
                241,
                262,
                72,
                93,
                114,
                133,
                171,
                209,
                228,
                247,
                266,
                264,
                285,
                14,
                35,
                54,
                73,
                261,
                282,
                94,
                134,
                172,
                267,
                286,
                15,
                55,
                74,
                281,
                283,
                302,
                154,
                173,
                192,
                268,
                287,
                306,
                16,
                56,
                301,
                322,
                155,
                212,
                269,
                288,
                307,
                326,
                17,
                76,
                321,
                342,
                175,
                211,
                213,
                232,
                249,
                270,
                308,
                327,
                325,
                346,
                18,
                37,
                77,
                96,
                341,
                343,
                362,
                214,
                233,
                252,
                250,
                271,
                290,
                347,
                324,
                345,
                366,
                19,
                38,
                78,
                116,
                361,
                344,
            ],
        ),
        (
            [287, 267, 268, 269, 249, 250, 251, 252, 232, 233, 234, 235, 255, 256, 276, 296, 316, 336, 356],
            [
                287,
                267,
                286,
                288,
                307,
                247,
                266,
                268,
                285,
                306,
                308,
                327,
                227,
                246,
                265,
                269,
                326,
                347,
                207,
                226,
                228,
                245,
                264,
                249,
                270,
                325,
                346,
                348,
                187,
                208,
                225,
                244,
                250,
                271,
                290,
                324,
                345,
                366,
                349,
                167,
                186,
                188,
                209,
                205,
                243,
                251,
                272,
                310,
                344,
                386,
                329,
                369,
                147,
                168,
                185,
                204,
                223,
                242,
                252,
                311,
                330,
                343,
                364,
                385,
                387,
                146,
                148,
                169,
                165,
                184,
                203,
                222,
                241,
                262,
                232,
                253,
                342,
                388,
                126,
                145,
                128,
                149,
                164,
                183,
                202,
                261,
                282,
                212,
                233,
                322,
                341,
                362,
                106,
                125,
                144,
                108,
                129,
                150,
                163,
                182,
                201,
                281,
                283,
                302,
                192,
                211,
                213,
                234,
                321,
                361,
                382,
                86,
                105,
                107,
                124,
                109,
                151,
                162,
                301,
                172,
                214,
                235,
                381,
                383,
                85,
                87,
                89,
                110,
                131,
                171,
                142,
                161,
                173,
                194,
                215,
                255,
                65,
                84,
                67,
                90,
                111,
                122,
                141,
                216,
                256,
                275,
                64,
                47,
                68,
                70,
                91,
                112,
                102,
                217,
                276,
                274,
                295,
                63,
                27,
                46,
                48,
                92,
                113,
                101,
                197,
                218,
                237,
                277,
                296,
                294,
                315,
                43,
                62,
                7,
                26,
                49,
                72,
                93,
                114,
                133,
                81,
                177,
                198,
                219,
                238,
                278,
                297,
                316,
                335,
                23,
                42,
                61,
                6,
                8,
                25,
                29,
                73,
                94,
                134,
                157,
                178,
                258,
                298,
                317,
                336,
                334,
                355,
                3,
                24,
                41,
                5,
                9,
                30,
                53,
                74,
                154,
                137,
                158,
                259,
                299,
                337,
                356,
            ],
        ),
    ]

    # test grid 2 id
    expected_results[11] = [
        (
            [
                386,
                366,
                346,
                326,
                306,
                286,
                266,
                267,
                268,
                269,
                249,
                250,
                251,
                252,
                232,
                212,
                213,
                214,
                215,
                216,
                217,
                197,
                177,
                157,
                137,
                117,
                118,
                98,
            ],
            [
                386,
                366,
                346,
                326,
                306,
                286,
                266,
                246,
                226,
                225,
                205,
                185,
                165,
                145,
                125,
                105,
                85,
                65,
                64,
                63,
                43,
                23,
                3,
                2,
                1,
                21,
                41,
                61,
                24,
                25,
                5,
                6,
                7,
                8,
                27,
                26,
                46,
                47,
                48,
                67,
                42,
                62,
                84,
                86,
                87,
                107,
                108,
                109,
                89,
                90,
                70,
                91,
                92,
                72,
                73,
                93,
                94,
                113,
                112,
                111,
                131,
                151,
                110,
                129,
                149,
                148,
                147,
                167,
                187,
                168,
                188,
                208,
                150,
                169,
                128,
                106,
                124,
                126,
                144,
                146,
                164,
                163,
                162,
                142,
                122,
                102,
                101,
                81,
                141,
                161,
                182,
                202,
                201,
                203,
                223,
                243,
                242,
                241,
                261,
                281,
                282,
                283,
                302,
                322,
                301,
                321,
                341,
                262,
                244,
                264,
                222,
                183,
                184,
                186,
                204,
                227,
                207,
                228,
                245,
                247,
                265,
                267,
                268,
                269,
                249,
                250,
                251,
                252,
                232,
                212,
                192,
                172,
                171,
                173,
                211,
                213,
                214,
                194,
                215,
                216,
                217,
                197,
                177,
                157,
                137,
                117,
                116,
                96,
                118,
                98,
            ],
        ),
        (
            [
                43,
                23,
                3,
                2,
                1,
                21,
                41,
                61,
                81,
                101,
                102,
                122,
                142,
                162,
                182,
                202,
                222,
                242,
                241,
                261,
                281,
                282,
                302,
                322,
                342,
                343,
                344,
            ],
            [
                43,
                23,
                3,
                2,
                1,
                21,
                41,
                61,
                62,
                81,
                101,
                102,
                122,
                142,
                141,
                161,
                162,
                163,
                164,
                144,
                124,
                125,
                105,
                85,
                65,
                64,
                84,
                86,
                87,
                67,
                47,
                27,
                7,
                6,
                5,
                8,
                9,
                26,
                25,
                46,
                48,
                49,
                29,
                30,
                68,
                107,
                108,
                109,
                89,
                90,
                70,
                91,
                110,
                111,
                112,
                131,
                129,
                149,
                148,
                150,
                169,
                128,
                106,
                126,
                146,
                147,
                167,
                168,
                188,
                208,
                207,
                227,
                226,
                247,
                209,
                228,
                187,
                186,
                185,
                205,
                204,
                203,
                225,
                245,
                145,
                165,
                184,
                183,
                182,
                202,
                201,
                222,
                223,
                243,
                244,
                264,
                265,
                266,
                246,
                267,
                268,
                269,
                249,
                250,
                251,
                270,
                271,
                272,
                290,
                310,
                288,
                308,
                307,
                306,
                327,
                287,
                286,
                285,
                242,
                241,
                261,
                281,
                282,
                283,
                302,
                322,
                321,
                341,
                361,
                362,
                382,
                381,
                342,
                343,
                344,
            ],
        ),
        (
            [287, 267, 268, 269, 249, 250, 251, 252, 232, 212, 213, 214, 215, 235, 255, 275, 295, 296, 316, 336, 356],
            [
                287,
                267,
                247,
                227,
                207,
                187,
                167,
                147,
                146,
                126,
                106,
                86,
                85,
                65,
                64,
                63,
                43,
                23,
                3,
                2,
                1,
                24,
                25,
                5,
                26,
                42,
                41,
                21,
                61,
                81,
                62,
                84,
                87,
                67,
                47,
                27,
                7,
                6,
                8,
                9,
                10,
                30,
                29,
                49,
                46,
                48,
                68,
                105,
                107,
                108,
                109,
                89,
                90,
                70,
                91,
                92,
                72,
                73,
                53,
                74,
                93,
                94,
                114,
                113,
                133,
                112,
                111,
                131,
                151,
                150,
                171,
                110,
                129,
                149,
                169,
                128,
                125,
                124,
                144,
                164,
                163,
                162,
                142,
                122,
                102,
                101,
                141,
                161,
                182,
                202,
                201,
                203,
                204,
                205,
                223,
                243,
                222,
                242,
                241,
                262,
                183,
                165,
                185,
                184,
                145,
                148,
                168,
                186,
                188,
                208,
                209,
                226,
                225,
                245,
                244,
                264,
                265,
                285,
                228,
                246,
                266,
                268,
                269,
                249,
                250,
                251,
                252,
                232,
                212,
                192,
                172,
                173,
                211,
                213,
                214,
                194,
                215,
                216,
                217,
                197,
                177,
                157,
                137,
                117,
                116,
                118,
                138,
                158,
                159,
                160,
                178,
                198,
                218,
                219,
                238,
                258,
                259,
                260,
                280,
                278,
                277,
                276,
                297,
                298,
                299,
                237,
                235,
                255,
                256,
                275,
                274,
                294,
                295,
                296,
                316,
                317,
                337,
                336,
                335,
                356,
            ],
        ),
    ]

    return expected_results
